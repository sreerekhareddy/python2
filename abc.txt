import pandas as pd
from openpyxl import load_workbook

failed_rings = []
successful_rings = []

# Define the Excel file path
excel_file_path = 'D:\\New folder (3)\\VerifyModelsReportCI.xlsx'

# ✅ Open the Workbook in Edit Mode (Without Saving)
wb = load_workbook(excel_file_path, data_only=True)  # Reads values instead of formulas
ws = wb['Results']  # Load the "Results" sheet

# ✅ Read Data into Pandas
df = pd.DataFrame(ws.values)  # Read values directly
df.columns = df.iloc[0]  # Set first row as column names
df = df[1:].reset_index(drop=True)  # Remove header row from data

# ✅ Strip column names (handles extra spaces)
df.columns = df.columns.str.strip()

# ✅ Check if "Ring" and "Mandatory" exist
if 'Ring' in df.columns and 'Mandatory' in df.columns:
    for i in df.index:
        ring = df.at[i, 'Ring']
        mandatory = df.at[i, 'Mandatory']

        if pd.notna(ring):  # Ensure Ring is not NaN
            if pd.isna(mandatory) or str(mandatory).strip() == '':  # Empty Mandatory
                if ring not in successful_rings and ring not in failed_rings:
                    successful_rings.append(ring)
            else:  # Non-empty Mandatory (contains value)
                if ring in successful_rings:
                    successful_rings.remove(ring)
                if ring not in failed_rings:
                    failed_rings.append(ring)

    # ✅ Print results
    print("Failed Rings:", failed_rings)
    print("Successful Rings:", successful_rings)
else:
    print("Error: 'Ring' or 'Mandatory' column not found in the Excel sheet!")

# ✅ Close workbook
wb.close()
